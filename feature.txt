Core functionality for the new feature
